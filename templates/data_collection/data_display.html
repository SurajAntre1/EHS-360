{% extends 'base/base.html' %}
{% load static %}

{% block title %}View Environmental Data{% endblock %}
{% block page_title %}View Environmental Data{% endblock %}

{% block extra_css %}
<style>
.data-display-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 1.5rem;
}

.header-section {
    background: linear-gradient(135deg, #059669 0%, #047857 100%);
    border-radius: 0.75rem;
    padding: 2rem;
    margin-bottom: 1.5rem;
    color: white;
}

.display-table {
    width: 100%;
    background: white;
    border-collapse: collapse;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    border-radius: 0.5rem;
    overflow: hidden;
}

.display-table thead {
    background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
}

.display-table th,
.display-table td {
    padding: 1rem;
    text-align: left;
    border-bottom: 1px solid #e2e8f0;
}

.display-table th {
    font-weight: 700;
    color: #1e293b;
}

.display-table tbody tr:hover {
    background: #f8fafc;
}
</style>
{% endblock %}

{% block content %}
<div class="data-display-container">
    <div class="header-section">
        <h2>View Environmental Data</h2>
        <p>Plant: {{ plant.name }}</p>
    </div>

    {% if user_plants.count > 1 %}
    <div style="margin-bottom: 1.5rem;">
        <label>Select Plant:</label>
        <select onchange="window.location.href='?plant_id='+this.value">
            {% for p in user_plants %}
            <option value="{{ p.id }}" {% if p.id == plant.id %}selected{% endif %}>
                {{ p.name }}
            </option>
            {% endfor %}
        </select>
    </div>
    {% endif %}

    <table class="display-table">
        <thead>
            <tr>
                <th>Environmental Indicator</th>
                {% for month in months %}
                <th>{{ month }}</th>
                {% endfor %}
                <th>Annual Total</th>
            </tr>
        </thead>
        <tbody>
            {% for q in questions_data %}
            <tr>
                <td><strong>{{ q.question }}</strong> ({{ q.unit }})</td>
                {% for month in months %}
                <td>{{ q.month_data|get_item:month|default:"-" }}</td>
                {% endfor %}
                <td><strong>{{ q.annual|default:"-" }}</strong></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}